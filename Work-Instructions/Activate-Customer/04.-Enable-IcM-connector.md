#Overview
Within IcM the connector needs to be activated with an unique certificate.

#Activities
[Download](https://ssladminhre/) the certificate to local computer: Base64 Encoded (.cer)
Go to [Add Connector](https://icm.ad.msft.net/imp/v3/administration/connectoronboarding) using parameters connector
Store the Connector ID (GUID) that is created in [VSTS Library](https://easplatform.visualstudio.com/Monitoring/_library?itemType=VariableGroups):

- Create new Variable Group named: `ICM-{ServiceID}`
- Store connector ID as variable named: `CON-{ServiceID}`

[Install certificate](https://microsoft.sharepoint.com/sites/itweb/faq/identity/Pages/Installing-SSL-Certificates.aspx) on local machine (not user) in personal folder.
Execute [PowerShell script](https://easplatform.visualstudio.com/_git/Monitoring?path=%2FBusinessLogic%2FAzureDeploy%2FPost-AddCustCertToVault.ps1) to create secrets in IcM Key Vault using parameters PowerShell Script
Upload certificate to [VSTS secure files](https://easplatform.visualstudio.com/Monitoring/_library?itemType=SecureFiles) from local disk: `C:\CERT-{ServiceID}.pfx`
Delete certificates files (.CER and .PFX) from local disk and certificate store 

#Notes
Use the same computer to create the certificate (step 3) and enable IcM connector (step 4).

#Parameters
##IcM Connector
|Item|Value|Comment|
|---|---|---|
|Service|{ServiceID}| |
|Cloud Instance|Public| |
|Alert Source|Custom| |
|Cert Subject|{ConnectorName}|Auto-populate by uploading cert|
|Cert Tumbprint|{thumbprint}|Auto-populate by uploading cert|
|Connector Name|{ConnectorName}| Cannot be same name as connector Name |
|Connector Owning Team|Triage| |

##PowerShell Script
|Item|Value|Comment|
|---|---|---|
|CertificateName| {ConnectorName} |name of certificate installed in local certificate store|
|keyVaultName| KVL-PROD-ICM-Connector | Default production vault for IcM|
|resourgeGroupName| BusinessLogic-PROD| Resource group containing the Key Vault|
|serviceID|{ServiceID}| |
|connectorID| {connectorID} | GUID stored in variables named: `CON-{ServiceID}`|
